---
title: 支付系统
comments: true
date: 2018-05-20 22:08:00
updated: 2018-05-20 22:08:00
tags: 
- 支付系统
categories:
- 业务
- 支付

---

# 作用
- 为订单提供正向支付和逆向退款

# 总体流程
- 支付系统上下游时序图

# 内部逻辑

- 订单支付（退款）状态扭转
	- 订单和支付流水1：n
	- 混付：内部支付渠道（余额/礼品卡）+外部支付渠道
- 支付渠道（外部）对接（支付网关）
	- 支付：支付（落单）、支付查询
	- 退款：退款、退款查询
	- 签约：签约、解约、查询
	- 回调通知：支付、退款、签约结果回调
	- 个性化收银台列表：支付方式、收款账号、排序
- 业务补偿
	- 支付（退款）状态补偿查询
	- 订单取消、超时支付成功自动退款
	- 重复支付自动退款

